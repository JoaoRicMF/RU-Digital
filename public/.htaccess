DirectoryIndex index.html index.php
Options -Indexes

RewriteEngine On

# 1. CORREÇÃO PARA O TOKEN JWT (Repassa o cabeçalho Authorization para o PHP)
RewriteCond %{HTTP:Authorization} ^(.*)
RewriteRule .* - [E=HTTP_AUTHORIZATION:%1]

# 2. PERMITE ACESSO DIRETO (Se o arquivo ou pasta existir, abre ele diretamente)
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# 3. ROTAS DA API (Tudo que começa com /api vai para o index.php)
RewriteRule ^api(/.*)?$ index.php [QSA,L,NC]

# 4. SPA FALLBACK (Qualquer outra rota vai para o index.html da interface)
RewriteRule ^ index.html [L]

# Cabeçalhos de segurança
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options    "nosniff"
    Header always set X-Frame-Options           "DENY"
    Header always set Referrer-Policy           "no-referrer"
    Header always set X-XSS-Protection          "1; mode=block"
</IfModule>
